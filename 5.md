## Week5

我是谁，我在哪，我要干什么？？？

### 复现

#### 任务

基于starry-old，在qemu运行dora，控制机械臂

#### 环境配置

基本dora分析看https://github.com/Starry-OS/Dora-analysis 

需要用以下指令启动starry

```bash
make A=apps/monolithic_userboot FEATURES=img,sched_rr,lwext4_rust LOG=off ACCEL=n NET=y run 
```

fat32 的偶发会出现并发问题，先用ext4（很慢）

```shell
sudo apt install cmake
sudo apt install musl-tools
export CC=/usr/bin/x86_64-linux-musl-gcc
rustup target add x86_64-unknown-linux-musl
sudo ln -s /usr/bin/x86_64-linux-musl-gcc /usr/bin/x86_64-linux-musl-cc
```

机械臂配置看https://help.lebai.ltd/dev/docker.html

```
docker pull registry.cn-shanghai.aliyuncs.com/lebai/l-master:latest
```

```
docker run -it -d -p 80:80 -p 5170:5170 -p 5171:5171 -p 5180:5180 -p 3010:3010 -p 3020:3020 -p 3030:3030 -p 3050:3050 registry.cn-shanghai.aliyuncs.com/lebai/l-master:latest
```

 http://localhost/dashboard，验证码找老师要



##### linux+机械臂

```python
import requests

url = "http://localhost:3020"
payload = {
    "jsonrpc": "2.0",
    "method": "start_task",
    "params": [
        {
            "name": "main",
            "is_parallel": False,
            "loop_to": 1,
            "dir": "",
            "kind": "LUA",
            "params": ["hello"]
        }
    ],
    "id": 1
}
response = requests.post(url, json=payload)
print(response.json())
```

响应

```shell
{'jsonrpc': '2.0', 'id': 1, 'result': {'id': 3}}
```



##### Dora+linux

```shell
cargo run --example rust-dataflow
```

机械臂目前跑在docker里，到时候会有dora node在机械臂设备上，node怎么和机械臂通信？？？



**Dora+starry+机械臂**

```shell
./dora start benchmark.yml
```

PageFault

![a9b67715ee058e26f2393ecbe3bed39](C:\Users\liylo\Documents\WeChat Files\wxid_o153pakxlfm252\FileStorage\Temp\a9b67715ee058e26f2393ecbe3bed39.png)
